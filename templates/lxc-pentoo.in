#!/bin/bash

#
# LXC template for  Pentoo (Gentoo) ---Mainly as  Build container. 
# Tweaked  Pentoo by Necrose99 (Michael R. Lawrence) mike@michaellawrenceit.com
# http://madtrixz.pentoo.ch/ for nightly stage 4 's  
# Author: Guillaume Zitta <lxc@zitta.fr>
#
include lxc-gentoo.in 
USE="bazaar cvs darcs +git gpg g-sorcery mercurial squashfs subversion sync-plugin-portage test" Emerge layman svn git
## Lets build Layman so we can add pentoo overlay to the gentoo generic container and add "Spice"
## as well as our build use cases 
### get or prompt user to name container to pentoo but use Gentoo Build funtions. based on arch.

############# some other cool code hear for arch... 
## % AMD64 possibles for pentoo specifics % ##
#pentoo:pentoo/default/linux/amd64
 #pentoo:pentoo/default/linux/amd64/binary
# pentoo:pentoo/default/linux/amd64/bleeding_edge
#pentoo:pentoo/hardened/linux/amd64
#pentoo:pentoo/hardened/linux/amd64/binary
#pentoo:pentoo/hardened/linux/amd64/bleeding_edge


## for binary type updates will be faster , and for the moment this will do user may switch latter
### with whatever i'll have to run pentoo in vm with x86 to probe for Exact.... string.. but I assume its close.
eselect profile set pentoo:pentoo/default/linux/amd64/binary


# This will become the pentoo-updater script soon # it is pentoo-updater.sh 

# This syncs the gentoo and pentoo repos like "apt-get update" in debian
emerge --sync
# This updates all the normal packages like "apt-get upgrade" in debian
emerge --deep --update --newuse world -vt
# This optionally merges in changed config files. unchanged files are merged automatically
etc-update
# This removes old packages which are not needed like "apt-get autoremove" in debian
emerge --depclean
# This rebuilds anything which may have been broken in update
emerge @preserved-rebuild
# This checks all the programs installed from VCS for new revisions and updates if needed
smart-live-rebuild
# Verifies there is no breakage after updates
revdep-rebuild
#merge in any new config files
etc-update
#clean up the distfiles/packages dirs to remove old/un-needed files
eclean-dist -d && eclean-pkg -d
# Check /var/log/portage/elog/summary.log file
# You might need to run extra commands. For example:
emerge @x11-module-rebuild
eselect java-vm set system icedtea-bin-7

# Run the following command under each regular user's account
# Regenerate the main menu for XFCE WM (or "-e" for e17, "-k" for KDE)
genmenu.py -x 
